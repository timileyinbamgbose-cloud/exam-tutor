# Kustomize Overlay for Phase 5: Scale (10x capacity)
# Supports 10,000+ concurrent users
# Target: 50 schools, 10,000 students

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: examstutor-prod

bases:
  - ../../base

# Scale-specific patches
patchesStrategicMerge:
  - deployment-scale-patch.yaml
  - hpa-scale-patch.yaml
  - service-patch.yaml
  - database-patch.yaml

resources:
  - redis-cluster.yaml
  - cdn-config.yaml

configMapGenerator:
  - name: app-config
    behavior: merge
    literals:
      - ENVIRONMENT=production-scale
      - LOG_LEVEL=INFO
      - MAX_CONCURRENT_USERS=10000
      - API_RATE_LIMIT=3000  # requests/second
      - DATABASE_POOL_SIZE=100
      - REDIS_CLUSTER_ENABLED=true
      - CDN_ENABLED=true
      - MONITORING_ENHANCED=true

images:
  - name: examstutor-api
    newName: examstutor/api
    newTag: "0.6.0-scale"
